




<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Inquiries ‚Äî Gene's Lechon Admin</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link rel="stylesheet" href="css/Inquiries.css"/>
  <link rel="stylesheet" href="css/layout.css"/>
</head>
<body>

<aside id="sidebar-placeholder"></aside>

<main class="main" id="main">

  <div class="topbar">
    <div class="topbar-left">
      <button id="hamburgerBtn" class="menu-btn"><i class="fas fa-bars"></i></button>
      <div class="page-title">
        <h1>Inquiries</h1>
        <p id="currentDate"></p>
      </div>
    </div>
    <div class="topbar-right">
      <div class="search-bar">
        <i class="fas fa-search"></i>
        <input type="text" id="globalSearch" placeholder="Search inquiries..." oninput="handleSearch(this.value)"/>
      </div>

      <!-- NOTIFICATION BELL -->
      <div class="notif-wrap" id="notifWrap">
        <button class="notif-btn" id="notifBtn" onclick="toggleNotifPanel()">
          <i class="fas fa-bell"></i>
          <span class="notif-badge" id="notifBadge" style="display:none;">0</span>
        </button>
        <div class="notif-panel" id="notifPanel">
          <div class="notif-panel-header">
            <span><i class="fas fa-bell" style="color:var(--primary);margin-right:6px;"></i>Notifications</span>
            <button class="notif-clear-all" onclick="clearAllNotifs()">Clear all</button>
          </div>
          <div class="notif-list" id="notifList">
            <div class="notif-empty">
              <i class="fas fa-check-circle"></i>
              <p>All caught up!</p>
            </div>
          </div>
        </div>
      </div>

      <div class="admin-profile">
        <div class="admin-avatar">A</div>
        <span>Admin</span>
      </div>
    </div>
  </div>

  <!-- STATS -->
  <div class="stats-row">
    <div class="stat-card orange">
      <div class="stat-icon"><i class="fas fa-inbox"></i></div>
      <div class="stat-info"><div class="stat-num" id="statTotal">0</div><div class="stat-lbl">Total Inquiries</div></div>
    </div>
    <div class="stat-card blue">
      <div class="stat-icon"><i class="fas fa-clock"></i></div>
      <div class="stat-info"><div class="stat-num" id="statPending">0</div><div class="stat-lbl">Pending</div></div>
    </div>
    <div class="stat-card green">
      <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
      <div class="stat-info"><div class="stat-num" id="statConfirmed">0</div><div class="stat-lbl">Confirmed</div></div>
    </div>
    <div class="stat-card purple">
      <div class="stat-icon"><i class="fas fa-truck"></i></div>
      <div class="stat-info"><div class="stat-num" id="statReady">0</div><div class="stat-lbl">Ready / Fulfilled</div></div>
    </div>
    <div class="stat-card dark">
      <div class="stat-icon"><i class="fas fa-archive"></i></div>
      <div class="stat-info"><div class="stat-num" id="statArchived">0</div><div class="stat-lbl">Archived</div></div>
    </div>
  </div>

  <!-- TABLE CARD -->
  <div class="table-card">
    <div class="filter-bar">

      <!-- Filter tabs -->
      <div class="filter-tabs" id="filterTabs">
        <button class="ftab active" onclick="setFilter('all', this)">All</button>
        <button class="ftab" onclick="setFilter('pending', this)"><i class="fas fa-clock"></i> Pending</button>
        <button class="ftab" onclick="setFilter('confirmed', this)"><i class="fas fa-check"></i> Confirmed</button>
        <button class="ftab" onclick="setFilter('ready', this)"><i class="fas fa-truck"></i> Ready</button>
        <button class="ftab" onclick="setFilter('cancelled', this)"><i class="fas fa-times"></i> Cancelled</button>
        <button class="ftab ftab-archive" onclick="switchView('archive', this)">
          <i class="fas fa-archive"></i> Archive
          <span class="archive-count" id="archiveTabCount" style="display:none;"></span>
        </button>
      </div>

      <!-- Date filter + reset + export ‚Äî all in one row, no overlap -->
      <div class="filter-actions">
        <div class="date-range">
          <i class="fas fa-calendar-alt"></i>
          <input type="date" id="dateFrom" onchange="applyDateFilter()"/>
          <span>‚Äî</span>
          <input type="date" id="dateTo" onchange="applyDateFilter()"/>
        </div>
        <!-- Reset button sits OUTSIDE date-range box so it never overlaps -->
        <button class="btn-date-reset" id="dateResetBtn" onclick="resetDateFilter()" style="display:none;">
          <i class="fas fa-times-circle"></i> Reset
        </button>
        <button class="btn-export" onclick="exportCSV()">
          <i class="fas fa-download"></i> Export CSV
        </button>
      </div>

    </div>

    <div class="table-wrap">
      <table id="inquiryTable">
        <thead>
          <tr>
            <th><input type="checkbox" id="selectAll" onchange="toggleSelectAll(this)"/></th>
            <th onclick="sortBy('orderId')"   class="sortable">Order ID <i class="fas fa-sort"></i></th>
            <th onclick="sortBy('customer')"  class="sortable">Customer <i class="fas fa-sort"></i></th>
            <th onclick="sortBy('date')"      class="sortable">Inquiry Date <i class="fas fa-sort"></i></th>
            <th onclick="sortBy('orderDate')" class="sortable">Order Date <i class="fas fa-sort"></i></th>
            <th>Items</th>
            <th onclick="sortBy('total')"     class="sortable">Total <i class="fas fa-sort"></i></th>
            <th id="statusHeader">Status</th>
            <th id="actionsHeader">Actions</th>
          </tr>
        </thead>
        <tbody id="inquiryBody"></tbody>
      </table>
      <div class="empty-state" id="emptyState" style="display:none;">
        <div class="empty-icon"><i class="fas fa-envelope-open"></i></div>
        <h3 id="emptyTitle">No inquiries found</h3>
        <p id="emptyMsg">Inquiries from the landing page will appear here in real-time.</p>
      </div>
      <div class="loading-state" id="loadingState">
        <div class="spinner"></div>
        <p>Loading inquiries...</p>
      </div>
    </div>

    <div class="pagination" id="pagination"></div>
  </div>

</main>

<!-- ‚îÄ‚îÄ MODALS ‚îÄ‚îÄ -->

<!-- Detail Modal -->
<div class="modal-overlay" id="detailModal">
  <div class="modal-box large">
    <div class="modal-header">
      <div class="modal-title">
        <span class="modal-icon">üìã</span>
        <div>
          <h3 id="modalOrderId">Inquiry</h3>
          <span id="modalStatusBadge" class="status-badge"></span>
        </div>
      </div>
      <button class="modal-close" onclick="closeModal('detailModal')"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body" id="detailModalBody"></div>
  </div>
</div>

<!-- Reply Modal -->
<div class="modal-overlay" id="replyModal">
  <div class="modal-box medium">
    <div class="modal-header">
      <div class="modal-title">
        <span class="modal-icon">‚úâÔ∏è</span>
        <div>
          <h3>Reply to Customer</h3>
          <span id="replyRecipient" style="font-size:13px;opacity:0.8;font-weight:500;"></span>
        </div>
      </div>
      <button class="modal-close" onclick="closeModal('replyModal')"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body">
      <div class="reply-tabs">
        <button class="rtab active" onclick="switchReplyTab('email', this)"><i class="fas fa-envelope"></i> Email</button>
        <button class="rtab" onclick="switchReplyTab('sms', this)"><i class="fas fa-sms"></i> SMS / Phone</button>
      </div>
      <div id="replyEmailSection">
        <div class="form-group"><label>To (Gmail)</label><input type="email" id="replyTo" readonly/></div>
        <div class="form-group"><label>Subject</label><input type="text" id="replySubject"/></div>
        <div class="form-group"><label>Message</label><textarea id="replyMessage" rows="6" placeholder="Write your reply..."></textarea></div>
        <div class="quick-replies">
          <p class="qr-label">Quick Replies:</p>
          <div class="qr-chips" id="qrChips"></div>
        </div>
        <div class="modal-footer">
          <button class="btn-secondary" onclick="closeModal('replyModal')">Cancel</button>
          <button class="btn-primary" onclick="sendEmailReply()"><i class="fas fa-paper-plane"></i> Send via Gmail</button>
        </div>
      </div>
      <div id="replySmsSection" style="display:none;">
        <div class="sms-info">
          <i class="fas fa-phone-alt"></i>
          <div><strong id="smsPhone"></strong><span>Copy and send via SMS / Viber / WhatsApp</span></div>
        </div>
        <div class="form-group"><label>Message</label><textarea id="smsMessage" rows="6"></textarea></div>
        <div class="modal-footer">
          <button class="btn-secondary" onclick="closeModal('replyModal')">Cancel</button>
          <button class="btn-primary" onclick="copySmsMessage()"><i class="fas fa-copy"></i> Copy Message</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Archive Modal -->
<div class="modal-overlay" id="archiveModal">
  <div class="modal-box small">
    <div class="modal-header" style="background:#6d5a9e;">
      <div class="modal-title"><span class="modal-icon">üì¶</span><h3>Archive Inquiry</h3></div>
      <button class="modal-close" onclick="closeModal('archiveModal')"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body" style="text-align:center;padding:28px 24px;">
      <p style="font-size:15px;font-weight:600;margin-bottom:8px;">Move this inquiry to archive?</p>
      <p style="font-size:13px;color:var(--text-grey);">Can be <strong>restored anytime</strong> from the Archive tab.</p>
    </div>
    <div class="modal-footer" style="padding:0 24px 24px;">
      <button class="btn-secondary" onclick="closeModal('archiveModal')">Cancel</button>
      <button class="btn-archive-confirm" onclick="confirmArchive()" id="confirmArchiveBtn"><i class="fas fa-archive"></i> Archive</button>
    </div>
  </div>
</div>

<!-- Restore Modal -->
<div class="modal-overlay" id="restoreModal">
  <div class="modal-box small">
    <div class="modal-header" style="background:#2e7d32;">
      <div class="modal-title"><span class="modal-icon">‚ôªÔ∏è</span><h3>Restore Inquiry</h3></div>
      <button class="modal-close" onclick="closeModal('restoreModal')"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body" style="text-align:center;padding:28px 24px;">
      <p style="font-size:15px;font-weight:600;margin-bottom:8px;">Restore this inquiry?</p>
      <p style="font-size:13px;color:var(--text-grey);">It will move back to the <strong>active inquiries</strong> list.</p>
    </div>
    <div class="modal-footer" style="padding:0 24px 24px;">
      <button class="btn-secondary" onclick="closeModal('restoreModal')">Cancel</button>
      <button class="btn-restore" onclick="confirmRestore()" id="confirmRestoreBtn"><i class="fas fa-undo"></i> Restore</button>
    </div>
  </div>
</div>

<!-- Delete Modal -->
<div class="modal-overlay" id="deleteModal">
  <div class="modal-box small">
    <div class="modal-header danger">
      <div class="modal-title"><span class="modal-icon">üóëÔ∏è</span><h3>Delete Forever</h3></div>
      <button class="modal-close" onclick="closeModal('deleteModal')"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body" style="text-align:center;padding:28px 24px;">
      <p style="font-size:15px;font-weight:600;margin-bottom:8px;">Permanently delete this inquiry?</p>
      <p style="font-size:13px;color:var(--text-grey);">This <strong style="color:#c62828;">cannot be undone</strong>.</p>
    </div>
    <div class="modal-footer" style="padding:0 24px 24px;">
      <button class="btn-secondary" onclick="closeModal('deleteModal')">Cancel</button>
      <button class="btn-danger" onclick="confirmDelete()" id="confirmDeleteBtn"><i class="fas fa-trash"></i> Delete Forever</button>
    </div>
  </div>
</div>

<div id="toastContainer"></div>

<!-- Scripts -->
<script type="module">
  import { initSidebar } from './js/sidebar.js';
  document.addEventListener('DOMContentLoaded', () => { initSidebar(); });
</script>
<script type="module" src="js/auth.js"></script>
<script type="module" src="js/Inquiries.js"></script>

</body>
</html>